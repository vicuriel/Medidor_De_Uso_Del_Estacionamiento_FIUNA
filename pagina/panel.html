<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Panel | FIUNA</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .row { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 12px; }
    .btn {
      padding: 12px 16px; border: 0; border-radius: 12px; font-weight: 700; cursor: pointer;
      background: linear-gradient(135deg, var(--primary, #22d3ee), #60a5fa);
      color: #0b1220; box-shadow: var(--shadow, 0 10px 30px rgba(0,0,0,.35));
    }
    .btn.secondary { background: #0b1220; color: #e5e7eb; }
    .status-ok { color: #22d3ee; }
    .status-err { color: #ef4444; }
  </style>
</head>
<body>
  <main class="container">
    <section class="card">
      <h1>Panel de Control</h1>
      <p class="subtitle">Control de LED en ESP32 via HTTP</p>

      <div class="row">
        <button id="btnOn"  class="btn">Encender LED</button>
        <button id="btnOff" class="btn secondary">Apagar LED</button>
      </div>

      <p id="status" class="helper" style="margin-top:14px">Estado: listo</p>
      <a class="link" href="login.html">← Volver al login</a>
    </section>
  </main>

  <script>
    //  Cambia esta IP por la que imprime tu ESP32 en el Monitor Serial
    const ESP_IP = "http://172.16.254.227";

    const statusEl = document.getElementById('status');
    const btnOn = document.getElementById('btnOn');
    const btnOff = document.getElementById('btnOff');

    async function call(path) {
      try {
        statusEl.textContent = `Llamando ${path} ...`;
        const r = await fetch(`${ESP_IP}${path}`, { method: "GET", cache: "no-store" });
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        const data = await r.json().catch(() => ({}));
        statusEl.innerHTML = `OK: ${path} <span class="status-ok">✔</span>`;
        return data;
      } catch (e) {
        statusEl.innerHTML = `Error: ${path} <span class="status-err">✖</span> — ${e}`;
      }
    }

    btnOn.addEventListener('click', () => call('/led/on'));
    btnOff.addEventListener('click', () => call('/led/off'));
  </script>
</body>
</html>
